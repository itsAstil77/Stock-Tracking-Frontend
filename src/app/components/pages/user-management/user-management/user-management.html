<nav class="navbar">

  <div class="navbar-left">
    <span class="navbar-title">User Management</span>
  </div>

  <div class="navbar-right">
    <div class="tooltip-container">
      <button class="icon-button"><img src="assets/refresh.png" (click)="reloadPage()" alt="Refresh"></button>
      <span class="tooltip-text">Refresh</span>
    </div>
    <div class="tooltip-container">
      <button class="icon-button"><img src="assets/add.png" (click)="openAddUserPopup()" alt="Add"></button>
      <span class="tooltip-text">Add</span>
    </div>
    <!-- <div class="tooltip-container">

      <button class="icon-button"><img src="assets/download.png"  alt="Download"></button>
      <span class="tooltip-text">Upload File</span>
    </div>
    <div class="tooltip-container">
      <button class="icon-button"><img src="assets/page.png"></button>
      <span class="tooltip-text">Column Picker</span>
    </div> -->
  </div>
</nav>

<div class="table-container" *ngIf="users.length > 0">
  <table class="company-table">
    <thead>
      <tr>
        <th>User Name</th>
        <th>Email</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users; let i = index">

        <td>{{ user.userName }}</td>
        <td>{{ user.email }}</td>
        <!-- <td>
          <span *ngIf="user.assignedRoles.length === 0">None</span>
          <ul *ngIf="user.assignedRoles.length > 0">
            <li *ngFor="let role of user.assignedRoles">{{ role }}</li>
          </ul>
        </td> -->
         <td>
            <div class="tab">
              <div class="tooltip-container">
                <img src="assets/edit.png" alt="Edit" (click)="openUpdateUserPopup(user)" class="tab-icon">
                <span class="tooltip-text">Edit</span>
              </div>
              <div class="tooltip-container">
                <img src="assets/delete.png" alt="Delete" (click)="openDeletePopup(user.id)" class="tab-icon">
                <span class="tooltip-text">Delete</span>
              </div>
            </div>
          </td>
      </tr>
    </tbody>
  </table>
</div>



<div class="modal" *ngIf="isAddUserPopupOpen">
  <div class="modal-content">
    <p>Add User</p>

    <div class="form-grid">
      <div class="form-group">
        <label>Username</label>
        <input type="text" [(ngModel)]="user.userName" />
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" [(ngModel)]="user.email" />
      </div>

      <div class="form-group">
        <label>Password</label>
        <div class="password-wrapper">
          <input [type]="isPasswordVisible ? 'text' : 'password'" [(ngModel)]="user.password" />
          <button type="button" class="eye-button" (click)="isPasswordVisible = !isPasswordVisible">
            <img [src]="isPasswordVisible ? 'assets/show.png' : 'assets/hide.png'" alt="Toggle visibility">
          </button>
        </div>
      </div>

      <div class="form-group">
        <label>Confirm Password</label>
        <div class="password-wrapper">
          <input [type]="isConfirmPasswordVisible ? 'text' : 'password'" [(ngModel)]="user.confirmPassword" />
          <button type="button" class="eye-button" (click)="isConfirmPasswordVisible = !isConfirmPasswordVisible">
            <img [src]="isConfirmPasswordVisible ? 'assets/show.png' : 'assets/hide.png'" alt="Toggle visibility">
          </button>
        </div>
      </div>
    </div>

    <div class="modal-buttons">
      <button type="button" (click)="closeAddUserPopup()">Cancel</button>
      <button type="button" (click)="createUser()">Add</button>
    </div>
  </div>
</div>



<div class="modal" *ngIf="isUpdateUserPopupOpen">
  <div class="modal-content">
    <p>Update User</p>

    <div class="form-grid">
      <div class="form-group">
        <label>Username</label>
        <input type="text" [(ngModel)]="user.userName" />
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" [(ngModel)]="user.email" />
      </div>

      <div class="form-group">
        <label>Password</label>
        <div class="password-wrapper">
          <input [type]="isPasswordVisible ? 'text' : 'password'" [(ngModel)]="user.password" />
          <button type="button" class="eye-button" (click)="isPasswordVisible = !isPasswordVisible">
            <img [src]="isPasswordVisible ? 'assets/show.png' : 'assets/hide.png'" alt="Toggle visibility">
          </button>
        </div>
      </div>

      <div class="form-group">
        <label>Confirm Password</label>
        <div class="password-wrapper">
          <input [type]="isConfirmPasswordVisible ? 'text' : 'password'" [(ngModel)]="user.confirmPassword" />
          <button type="button" class="eye-button" (click)="isConfirmPasswordVisible = !isConfirmPasswordVisible">
            <img [src]="isConfirmPasswordVisible ? 'assets/show.png' : 'assets/hide.png'" alt="Toggle visibility">
          </button>
        </div>
      </div>
    </div>

    <div class="modal-buttons">
      <button (click)="closeUpdateUserPopup()">Cancel</button>
      <button (click)="updateUser()">Update</button>
    </div>
  </div>
</div>


  <div class="delete-modal" *ngIf="isDeletePopupOpen">
    <div class="delete-modal-content">
      <p>Are you sure you want to delete this user?</p>
      <div class="delete-modal-buttons">

        <button class="delete-no-btn" (click)="closeDeletePopup()">No</button>
        <button class="delete-yes-btn" (click)="confirmDelete()">Yes</button>
      </div>
    </div>
  </div>